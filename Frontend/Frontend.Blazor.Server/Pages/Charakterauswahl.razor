@using DevExpress.ExpressApp
@using CoOrga.Survivors.Domain.BusinessObjects
@using DevExpress.Xpo
<h1>Wähle deinen Mitarbeiter</h1>
<style>
    .charakter-card:hover{
        cursor: pointer;
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    }

    .charakter-card{
        height:250px;
        width:250px;
        border: 1px dashed red;
        margin-right: 15px;
        display: inline-block;
    }

    .charakter-card img {
        max-height: 200px;
        display:block;
    }
    .abteilung-card {
        max-width: 1000px;
        margin-bottom: 50px;
    }
</style>
@if (CharaktereProAbteilung != null)
{
    @foreach (var abteilung in CharaktereProAbteilung)
    {
        <div class="abteilung-card">
            <h3>@abteilung.Key</h3>
            @foreach (var charakter in abteilung.OrderBy(c => c.SortIndex))
            {
                <div class="charakter-card">
                    <img src="@charakter.ImgUrl"/>
                </div>    
            }
        </div>    
    }
}

@code {

    [Parameter]
    public IObjectSpace ObjectSpace { get; set; }

    private List<IGrouping<string,Charakter>> CharaktereProAbteilung { get; set; }

    protected override async Task OnInitializedAsync()
    {
        CharaktereProAbteilung = await ObjectSpace.GetObjectsQuery<Charakter>()
                                      .GroupBy(c => c.Abteilung)
                                      .ToListAsync();
        
        await base.OnInitializedAsync();
    }
}
